alexa_tts:
  sequence:
  - service: alexa_media.update_last_called
    data: {}
  - delay:
      hours: 0
      minutes: 0
      seconds: 1
      milliseconds: 0
  - service: notify.alexa_media
    data_template:
      target:
      - '{{ states.sensor.last_alexa.state }}'
      data:
        type: tts
      message: Alex est {{ states.sensor.alex_gps_alexa.state }}
  mode: single
  alias: Alex gps Alexa
annonce_bonapp:
  alias: Annonce Alexa bon app
  sequence:
  - data:
      data:
        type: tts
      message: bon appétit !
      target:
      - media_player.le_bureau
      - media_player.le_salon
    service: notify.alexa_media
vol_2_rdc:
  alias: Vol 2 RDC
  sequence:
  - data:
      volume_level: 0.2
    service: media_player.volume_set
    target:
      entity_id:
      - media_player.le_bureau
      - media_player.le_salon
      - media_player.aurel_s_fire_tv_cube
      - media_player.la_cuisine
      - media_player.maman
      - media_player.papa
      - media_player.le_garage
  mode: single
vol_5_partout:
  alias: Vol 6 Partout
  sequence:
  - data:
      volume_level: 0.6
    entity_id: media_player.le_garage,media_player.aurel_s_fire_tv_cube,media_player.le_salon,media_player.le_bureau,media_player.papa,media_player.tom,media_player.nina,media_player.manon,media_player.leane,media_player.la_cuisine
    service: media_player.volume_set
  mode: single
vol_3_partout:
  alias: Vol 4 Partout
  sequence:
  - data:
      volume_level: 0.4
    service: media_player.volume_set
    target:
      entity_id: media_player.le_garage,media_player.aurel_s_fire_tv_cube,media_player.la_salle_de_bain,media_player.le_salon,media_player.le_bureau,media_player.papa,media_player.maman,media_player.tom,media_player.nina,media_player.manon,media_player.leane,media_player.la_cuisine
  mode: single
vol_1_chambre_enfants:
  alias: Vol 1 échos enfants
  sequence:
  - data:
      volume_level: 0.12
    entity_id: media_player.nina,media_player.tom,media_player.leane,media_player.manon
    service: media_player.volume_set
  mode: single
bonapp_notif_tv:
  alias: Bon app (message tv)
  sequence:
  - data:
      message: Bon appétit les amoureux !
    service: notify.tv_salon
  mode: single
vol_3_sejour:
  alias: Vol 3 séjour
  sequence:
  - data:
      volume_level: 0.3
    entity_id: media_player.le_salon,media_player.le_bureau
    service: media_player.volume_set
  mode: single
ambiance_repas:
  alias: Ambiance repas
  sequence:
  - if:
    - condition: state
      entity_id: media_player.tv_salon
      state: 'off'
    then:
    - service: script.tv_salon_on_off
      data: {}
  - scene: scene.repas_devant_tv
  - data: {}
    service: script.vol_3_sejour
  - timeout: 00:00:02
    wait_template: ''
  - scene: scene.repas_devant_tv
  - data: {}
    service: script.annonce_bonapp
  - delay: 00:00:10
  - data: {}
    service: script.bonapp_notif_tv
  - if:
    - condition: state
      entity_id: input_boolean.noel
      state: 'on'
    then:
    - service: switch.turn_off
      data: {}
      target:
        entity_id: switch.guirlande_etoiles
  mode: single
  icon: mdi:silverware-variant
npd_on_echos_enfants:
  alias: NPD ON échos étage
  sequence:
  - device_id: cb4921c1744240b7a12ec54a13ad35f6
    domain: switch
    entity_id: switch.manon_do_not_disturb_switch
    type: turn_on
  - device_id: c6f009055e09423a80b498878a043f25
    domain: switch
    entity_id: switch.leane_do_not_disturb_switch
    type: turn_on
  - device_id: 021f28bbf0ca4bf88cd9a927413278fa
    domain: switch
    entity_id: switch.nina_do_not_disturb_switch
    type: turn_on
  - device_id: 61b4fd52dfb14f3cb50792f9850fc5be
    domain: switch
    entity_id: switch.tom_do_not_disturb_switch
    type: turn_on
  - device_id: 26167c2b30ed4cdfac5f5295d7be2b8e
    domain: switch
    entity_id: switch.la_salle_de_bain_do_not_disturb_switch
    type: turn_on
  mode: single
npd_off_echos_enfants:
  alias: NPD OFF échos étage
  sequence:
  - device_id: cb4921c1744240b7a12ec54a13ad35f6
    domain: switch
    entity_id: switch.manon_do_not_disturb_switch
    type: turn_off
  - device_id: c6f009055e09423a80b498878a043f25
    domain: switch
    entity_id: switch.leane_do_not_disturb_switch
    type: turn_off
  - device_id: 021f28bbf0ca4bf88cd9a927413278fa
    domain: switch
    entity_id: switch.nina_do_not_disturb_switch
    type: turn_off
  - device_id: 61b4fd52dfb14f3cb50792f9850fc5be
    domain: switch
    entity_id: switch.tom_do_not_disturb_switch
    type: turn_off
  - device_id: 26167c2b30ed4cdfac5f5295d7be2b8e
    domain: switch
    entity_id: switch.la_salle_de_bain_do_not_disturb_switch
    type: turn_off
  mode: single
musique_off_etage:
  alias: Musique OFF échos enfants
  sequence:
  - data: {}
    entity_id: media_player.leane,media_player.manon,media_player.nina,media_player.tom
    service: media_player.media_stop
annonce_au_lit:
  alias: Filles couché
  sequence:
  - service: script.vol_5_partout
    data: {}
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - data:
      data:
        type: announce
      message: C'est l'heure d'aller au lit... {{ states.sensor.filles_reveil_annonce.state
        }}. Bonne nuit !
      target:
      - group.echos
    service: notify.alexa_media
  - delay:
      hours: 0
      minutes: 0
      seconds: 25
      milliseconds: 0
  - parallel:
    - service: scene.turn_on
      target:
        entity_id: scene.nina_ambiance_nuit
      metadata: {}
    - service: scene.turn_on
      target:
        entity_id: scene.grande_chambre_ambiance_nuit
      metadata: {}
    - service: script.vol_1_chambre_enfants
      data: {}
    - service: script.vol_2_rdc
      data: {}
  - wait_template: ''
    timeout: 00:01:00
    continue_on_timeout: true
  - parallel:
    - service: switch.turn_off
      target:
        entity_id:
        - switch.moustique_manon
        - switch.moustique_nina
      data: {}
    - type: turn_on
      device_id: cb4921c1744240b7a12ec54a13ad35f6
      entity_id: switch.manon_do_not_disturb_switch
      domain: switch
    - type: turn_on
      device_id: c6f009055e09423a80b498878a043f25
      entity_id: switch.leane_do_not_disturb_switch
      domain: switch
    - type: turn_on
      device_id: 021f28bbf0ca4bf88cd9a927413278fa
      entity_id: switch.nina_do_not_disturb_switch
      domain: switch
  - delay:
      hours: 0
      minutes: 5
      seconds: 0
      milliseconds: 0
  - if:
    - condition: state
      entity_id: input_boolean.noel
      state: 'on'
    then:
    - service: switch.turn_off
      data: {}
      target:
        entity_id: switch.guirlande_couloir
  mode: single
  icon: mdi:sleep
a_table:
  alias: A table !
  sequence:
  - data: {}
    service: script.musique_off_etage
  - data: {}
    service: script.vol_5_partout
  - delay:
      hours: 0
      minutes: 0
      seconds: 0
      milliseconds: 500
  - parallel:
    - data:
        data:
          type: announce
        message: C'est l'heure d'aller manger. Bon appétit !
        target:
        - group.echos
      service: notify.alexa_media
    - data:
        message: 'A table ! Bonn appétit ! '
      service: notify.tv_salon
    - if:
      - condition: or
        conditions:
        - condition: or
          conditions:
          - condition: state
            entity_id: binary_sensor.mouv_tom
            state: 'on'
          - condition: state
            entity_id: light.tom
            state: 'on'
      then:
      - service: light.turn_on
        target:
          entity_id:
          - light.lustre_tom
        data:
          effect: Flash
          brightness_pct: 100
    - if:
      - condition: or
        conditions:
        - condition: or
          conditions:
          - condition: state
            entity_id: binary_sensor.mouvements_manon_et_leane
            state: 'on'
          - condition: state
            entity_id: light.manon_et_leane
            state: 'on'
      then:
      - service: light.turn_on
        target:
          entity_id:
          - light.lustre_manon_et_leane
        data:
          effect: Flash
          brightness_pct: 100
    - if:
      - condition: or
        conditions:
        - condition: or
          conditions:
          - condition: state
            entity_id: binary_sensor.mouv_nina
            state: 'on'
          - condition: state
            entity_id: light.nina
            state: 'on'
      then:
      - service: light.turn_on
        target:
          entity_id:
          - light.lustre_nina
        data:
          effect: Flash
          brightness_pct: 100
    - if:
      - condition: or
        conditions:
        - condition: or
          conditions:
          - condition: state
            entity_id: switch.tele_des_parents
            state: 'on'
          - condition: state
            entity_id: light.parents
            state: 'on'
      then:
      - service: light.turn_on
        target:
          entity_id:
          - light.lustre_parents
        data:
          effect: Flash
          brightness_pct: 100
    - if:
      - condition: or
        conditions:
        - condition: or
          conditions:
          - condition: state
            entity_id: binary_sensor.mouvements_sejour
            state: 'on'
          - condition: state
            entity_id: light.sejour
            state: 'on'
          - condition: state
            entity_id: media_player.tv_salon
            state: 'on'
      then:
      - service: light.turn_on
        target:
          entity_id:
          - light.bandeau_led
        data:
          effect: Flash
          brightness_pct: 100
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  - service: script.vol_3_partout
    data: {}
  - service: light.turn_off
    target:
      entity_id:
      - light.lustre_parents
      - light.bandeau_led
    data: {}
  - delay:
      hours: 0
      minutes: 2
      seconds: 0
      milliseconds: 0
  - if:
    - condition: time
      after: '18:00:00'
      before: 00:00:00
    then:
    - service: media_player.volume_set
      data:
        volume_level: 0.5
      target:
        entity_id: media_player.la_cuisine
    - data:
        data:
          type: tts
        message: Tom, ton Roacutane !
        target:
        - media_player.la_cuisine
      service: notify.alexa_media
  mode: single
  icon: mdi:hamburger
tom_va_se_coucher:
  alias: 'Tom va au lit '
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: light.parents
        state: 'on'
      sequence:
      - data:
          volume_level: 0.2
        entity_id: media_player.aurel_s_fire_tv_cube, media_player.papa, media_player.tom,
          media_player.le_salon
        service: media_player.volume_set
      - service: light.turn_on
        target:
          entity_id:
          - light.lustre_tom
          - light.chevet_tom
          - light.lustre_parents
        data:
          effect: Flash
      - data:
          data:
            type: tts
          message: 'Tom, c''est l''heure d''aller te coucher.  {{ states.sensor.tom_reveil_annonce.state
            }}. Bonne nuit ! '
          target:
          - media_player.aurel_s_fire_tv_cube
          - media_player.tom
          - media_player.le_salon
          - media_player.papa
        service: notify.alexa_media
    - conditions:
      - condition: state
        entity_id: light.parents
        state: 'off'
      sequence:
      - data:
          volume_level: 0.2
        entity_id: media_player.tom, media_player.le_salon
        service: media_player.volume_set
      - service: light.turn_on
        target:
          entity_id:
          - light.lustre_tom
          - light.chevet_tom
        data:
          effect: Flash
      - data:
          data:
            type: tts
          message: 'Tom, c''est l''heure d''aller te coucher. {{ states.sensor.tom_reveil_annonce.state
            }}. Bonne nuit ! '
          target:
          - media_player.tom
          - media_player.le_salon
        service: notify.alexa_media
    default: []
  - service: light.turn_on
    target:
      entity_id:
      - light.lustre_tom
      - light.chevet_tom
    data:
      color_name: tomato
      brightness_pct: 50
  - delay: 00:00:45
  - service: scene.turn_on
    target:
      entity_id: scene.tom_ambiance_nuit
    metadata: {}
  - service: switch.turn_off
    target:
      entity_id: switch.moustique_tom
    data: {}
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.tom_do_not_disturb_switch
  mode: single
  icon: mdi:bed
'1590760144160':
  alias: Fin des écrans !
  sequence:
  - data: {}
    service: script.turn_on
    target:
      entity_id: script.vol_3_partout
  - data:
      data:
        type: announce
      message: 'C''est l''heure d’arrêter les écrans. Bisous '
      target:
      - group.echos
    service: notify.alexa_media
  - wait_template: ''
    timeout: 00:00:30
  mode: restart
  icon: phu:rooms-mancave
vol_10_partout:
  alias: Vol 10 partout
  sequence:
  - data:
      volume_level: 1
    entity_id: media_player.le_garage,media_player.aurel_s_fire_tv_cube,media_player.le_salon,media_player.le_bureau,media_player.papa,media_player.tom,media_player.nina,media_player.manon,media_player.leane,media_player.la_cuisine
    service: media_player.volume_set
  mode: single
alarm_alexa_alerte:
  alias: Alarme intrusion Alexa
  sequence:
  - data:
      data:
        type: tts
      message: attention. l'alarme est déclenchée, et les propriétaires sont prévenus
      target:
      - media_player.le_bureau
      - media_player.le_salon
      - media_player.la_cuisine
      - media_player.le_garage
    service: notify.alexa_media
  mode: single
alarme_alexa_alarme_off:
  alias: Alarme Alexa alarme off
  sequence:
  - data:
      data:
        type: tts
      message: 'lalarme est désactivé. Bienvenue a la maison.  '
      target:
      - media_player.le_bureau
    service: notify.alexa_media
apero_lum:
  alias: Apéro (lumières)
  sequence:
  - service: light.turn_off
    target:
      entity_id:
      - light.lustre_salle_a_manger
      - light.lustre_salon
  - data:
      color_temp: 290
      brightness_pct: 100
    service: light.turn_on
    target:
      entity_id: light.lampe_canape
  - data:
      effect: Slow Temp
    entity_id: light.lampadaire,light.bandeau_led
    service: light.turn_on
  - service: switch.turn_on
    target:
      entity_id: switch.lampe_tv_salon
  - service: light.turn_on
    target:
      entity_id: light.lampe_de_bureau
    data:
      color_temp: 500
      brightness_pct: 50
  mode: single
  icon: mdi:glass-cocktail
disco_lum:
  alias: Disco lumières
  sequence:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.lampe_tv_salon
  - service: light.turn_off
    target:
      entity_id:
      - light.lampe_canape
      - light.lampadaire
      - light.buffet
      - light.lampe_de_bureau
  - data:
      effect: Disco
    service: light.turn_on
    target:
      entity_id:
      - light.lustre_salle_a_manger
      - light.lustre_salon
      - light.bandeau_led
  mode: single
  icon: mdi:music
ambiance_cine_chevet_parents:
  alias: Ambiance ciné (lumières)
  icon: mdi:movie-open
  mode: single
  sequence:
  - service: light.turn_on
    data:
      effect: Ciné
    target:
      entity_id: light.lustre_parents
  - service: light.turn_on
    data:
      brightness_pct: 5
      rgb_color:
      - 170
      - 35
      - 255
    target:
      entity_id: light.chevet
cest_lheure_daller_a_lecole:
  alias: C'est l'heure d'aller à l'école
  icon: mdi:bus-school
  mode: single
  sequence:
  - data: {}
    service: script.vol_5_partout
  - delay: 00:00:01
  - data:
      volume_level: 1
    entity_id: media_player.le_salon
    service: media_player.volume_set
  - delay: 00:00:01
  - data:
      data:
        type: announce
      message: 'C''est l''heure de partir a l''école.  Très bonne journée ! '
      target:
      - group.echos
    service: notify.alexa_media
  - service: script.vol_3_partout
    data: {}
  - wait_template: ''
    timeout: 00:00:20
    continue_on_timeout: true
je_pars_de_la_maison:
  alias: Je pars de la maison (alarme)
  icon: mdi:logout-variant
  mode: single
  sequence:
  - data: {}
    entity_id: alarm_control_panel.alarme
    service: alarm_control_panel.alarm_arm_away
gouter:
  alias: C'est l'heure du gouter
  sequence:
  - service: script.vol_3_partout
    data: {}
  - timeout: 00:00:01
    wait_template: ''
    continue_on_timeout: true
  - data:
      data:
        type: announce
      message: Pour les zafamés, vous pouvez venir prendre un gouter !
      target:
      - group.echos
    service: notify.alexa_media
  - wait_template: ''
    timeout: 00:00:05
    continue_on_timeout: true
  - service: script.vol_2_rdc
    data: {}
  - wait_template: ''
    timeout: 00:00:20
    continue_on_timeout: true
  mode: single
  icon: mdi:food-croissant
sortir_l_aspi:
  alias: Prépare l’ aspirateur
  mode: single
  sequence:
  - data:
      x_coord: 26941
      y_coord: '30667'
    service: xiaomi_miio.vacuum_goto
    target:
      entity_id: vacuum.wall_e
  icon: mdi:bullseye-arrow
restart_ha:
  alias: Restart HA
  sequence:
  - service: homeassistant.restart
    data: {}
  mode: single
aspi_walle_salon:
  alias: passe l'aspiateur dans le salon
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 17
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
  icon: mdi:television
aspi_walle_bureau:
  alias: passe l'aspirateur dans le bureau
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 22
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
  icon: mdi:desk-lamp
aspi_walle_sejour:
  alias: passe l'aspirateur dans le séjour
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 20
      - 17
      - 22
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
  icon: mdi:sofa
aspi_walle_cuisine:
  alias: passe l'aspirateur dans la cuisine
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 16
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
  icon: mdi:food-fork-drink
aspi_salle_a_manger:
  alias: passe l'aspirateur dans la salle a manger
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 20
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
  icon: mdi:glass-wine
aspi_walle_entree:
  alias: passe l'aspirateur dans l'entrée
  sequence:
  - service: vacuum.send_command
    data:
      command: app_segment_clean
      params:
      - 24
      - 21
      - 21
    target:
      entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
  icon: mdi:door
aspi_walle_couloir:
  alias: passe l'aspirateur dans le couloir
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 25
      - 18
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
  icon: mdi:stairs
aspi_walle_tapis:
  alias: passe l'aspirateur sur le tapis
  sequence:
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 32552
        - 28759
        - 33768
        - 30558
      repeats: 3
      entity_id: vacuum.wall_e
  - delay:
      hours: 0
      minutes: 0
      seconds: 35
      milliseconds: 0
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Turbo
    entity_id: vacuum.wall_e
  mode: single
  icon: mdi:rug
aspi_walle_cagibi:
  alias: passe l'aspirateur dans le cagibi
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 23
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_wc:
  alias: passe l'aspirateur dans les wc
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 18
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_chambre_parents:
  alias: passe l'aspirateur dans la chambre des parents
  sequence:
  - service: vacuum.send_command
    data:
      entity_id: vacuum.wall_e
      command: app_segment_clean
      params:
      - 19
    entity_id: vacuum.wall_e
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  mode: single
  icon: phu:rooms-bedroom
aspi_walle_serpille_cuisine:
  alias: passe la serpillière dans la cuisine
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 23761
        - 28734
        - 27308
        - 31571
      repeats: 2
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_serpille_sejour:
  alias: passe la serpillière dans le séjour
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 24977
        - 24857
        - 33692
        - 28607
      repeats: 2
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_serpille_salle_a_manger:
  alias: passe la serpillière dans la salle à manger
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 25027
        - 24933
        - 28524
        - 28632
      repeats: 2
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_serpille_salon:
  alias: passe la serpillière dans le salon
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 28625
        - 25009
        - 31868
        - 28607
      repeats: 2
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_serpille_bureau:
  alias: passe la serpillière dans le bureau
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 31944
        - 24857
        - 33844
        - 28632
      repeats: 2
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_serpille_entree:
  alias: passe la serpillière dans l'entrée
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 28853
        - 28784
        - 32552
        - 30507
      repeats: 2
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_serpille_couloir:
  alias: passe la serpillière dans le couloir
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 27333
        - 28810
        - 28777
        - 33623
      - - 28802
        - 30608
        - 29765
        - 33547
      repeats: 2
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_serpille_chambre_parents:
  alias: passe la serpillière dans la chambre des parents
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.wall_e
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 23634
        - 31748
        - 27232
        - 35093
      repeats: 2
    entity_id: vacuum.wall_e
  mode: single
aspi_r2d2_salle_de_bain:
  alias: passe l’aspirateur dans la salle de bain
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.r2d2
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 27589
        - 24459
        - 30627
        - 27454
      repeats: 2
    entity_id: vacuum.r2d2
  mode: single
  icon: phu:rooms-bathroom
aspi_r2d2_chambre_tom:
  alias: passe l’aspirateur dans la chambre de Tom
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.r2d2
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 22780
        - 21316
        - 26598
        - 24332
      repeats: 2
    entity_id: vacuum.r2d2
  mode: single
  icon: mdi:bat
aspi_r2d2_chambre_nina:
  alias: passe l’aspirateur dans la chambre de Nina
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.r2d2
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 27589
        - 21505
        - 31217
        - 24374
      repeats: 2
    entity_id: vacuum.r2d2
  mode: single
  icon: phu:rooms-kids-bedroom
aspi_r2d2_chambre_manon_leane:
  alias: passe l’aspirateur dans la chambre de Manon et Léane
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.r2d2
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 22864
        - 17730
        - 31112
        - 21231
      repeats: 2
    entity_id: vacuum.r2d2
  mode: single
  icon: mdi:death-star-variant
aspi_r2d2_palier:
  alias: passe l’aspirateur sur le palier
  sequence:
  - service: vacuum.set_fan_speed
    data:
      fan_speed: Standard
    entity_id: vacuum.r2d2
  - service: xiaomi_miio.vacuum_clean_zone
    data:
      zone:
      - - 25227
        - 24501
        - 27526
        - 25809
      - - 26661
        - 21442
        - 27547
        - 24501
      repeats: 2
    entity_id: vacuum.r2d2
  mode: single
  icon: mdi:home-roof
aspi_walle_reset_brosse_principale:
  alias: Aspi Walle reset brosse principale
  sequence:
  - service: vacuum.send_command
    data:
      command: reset_consumable
      params:
      - main_brush_work_time
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_reset_brosse_laterale:
  alias: Aspi Walle reset brosse latérale
  sequence:
  - service: vacuum.send_command
    data:
      command: reset_consumable
      params:
      - side_brush_work_time
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_reset_filtre:
  alias: Aspi Walle reset filtre
  sequence:
  - service: vacuum.send_command
    data:
      command: reset_consumable
      params:
      - filter_work_time
    entity_id: vacuum.wall_e
  mode: single
aspi_walle_reset_capteurs:
  alias: Aspi Walle reset capteurs
  sequence:
  - service: vacuum.send_command
    data:
      command: reset_consumable
      params:
      - sensor_dirty_time
    entity_id: vacuum.wall_e
  mode: single
aspi_r2d2_reset_brosse_principale:
  alias: Aspi r2d2 reset brosse principale
  sequence:
  - service: vacuum.send_command
    data:
      command: reset_consumable
      params:
      - main_brush_work_time
    entity_id: vacuum.r2d2
  mode: single
aspi_r2d2_reset_brosse_laterale:
  alias: Aspi r2d2 reset brosse latérale
  sequence:
  - service: vacuum.send_command
    data:
      command: reset_consumable
      params:
      - side_brush_work_time
    entity_id: vacuum.r2d2
  mode: single
aspi_r2d2_reset_filtre:
  alias: Aspi r2d2 reset filtre
  sequence:
  - service: vacuum.send_command
    data:
      command: reset_consumable
      params:
      - filter_work_time
    entity_id: vacuum.r2d2
  mode: single
aspi_r2d2_reset_capteurs:
  alias: Aspi r2d2 reset capteurs
  sequence:
  - service: vacuum.send_command
    data:
      command: reset_consumable
      params:
      - sensor_dirty_time
    entity_id: vacuum.r2d2
  mode: single
douche_terminee:
  alias: Douche terminée
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: sensor.aleatoire
        state: '1'
      sequence:
      - data:
          data:
            type: tts
          message: Adios amigos
          target:
          - media_player.la_salle_de_bain
        service: notify.alexa_media
    - conditions:
      - condition: state
        entity_id: sensor.aleatoire
        state: '2'
      sequence:
      - data:
          data:
            type: tts
          message: 'OK, je s''occupe de tout, tu s''occupe de rien ! '
          target:
          - media_player.la_salle_de_bain
        service: notify.alexa_media
    - conditions:
      - condition: state
        entity_id: sensor.aleatoire
        state: '3'
      sequence:
      - data:
          data:
            type: tts
          message: 'Je s''appelle Groute. '
          target:
          - media_player.la_salle_de_bain
        service: notify.alexa_media
    - conditions:
      - condition: state
        entity_id: sensor.aleatoire
        state: '4'
      sequence:
      - data:
          data:
            type: tts
          message: j'ai compris, je m'occupe de tout...
          target:
          - media_player.la_salle_de_bain
        service: notify.alexa_media
    default:
    - data:
        data:
          type: tts
        message: OK, a bientot !
        target:
        - media_player.la_salle_de_bain
      service: notify.alexa_media
  - type: turn_off
    device_id: 1b52011e1c3f00a28baa2cf327f21148
    entity_id: switch.radiateur
    domain: switch
  mode: single
  icon: mdi:shower
douche_au_suivant:
  alias: Douche Au suivant
  sequence:
  - service: switch.turn_off
    target:
      entity_id: switch.radiateur
    data: {}
  - service: media_player.media_pause
    target:
      entity_id: media_player.partout
    data: {}
  - service: script.vol_3_partout
    data: {}
  - choose:
    - conditions:
      - condition: state
        entity_id: sensor.aleatoire
        state: '1'
      sequence:
      - data:
          data:
            type: announce
          message: Oyé oyé ! le suivant peut aller se savonner les fesses !
          target:
          - group.echos
        service: notify.alexa_media
    - conditions:
      - condition: state
        entity_id: sensor.aleatoire
        state: '2'
      sequence:
      - data:
          data:
            type: announce
          message: 'le suivant peut aller se faire tout beau tout propre. '
          target:
          - group.echos
        service: notify.alexa_media
    - conditions:
      - condition: state
        entity_id: sensor.aleatoire
        state: '3'
      sequence:
      - data:
          data:
            type: announce
          message: 'Suivant pour la douche... que la force soit avec toi ! '
          target:
          - group.echos
        service: notify.alexa_media
    - conditions:
      - condition: state
        entity_id: sensor.aleatoire
        state: '4'
      sequence:
      - data:
          data:
            type: announce
          message: Et un de plusse qui sent bon ! au suivant pour la douche s'il vous
            plait.
          target:
          - group.echos
        service: notify.alexa_media
    default:
    - data:
        data:
          type: announce
        message: Salle de bain dispo, au suivant !
        target:
        - group.echos
      service: notify.alexa_media
  - wait_template: ''
    timeout: 00:00:07
    continue_on_timeout: true
  - service: script.vol_2_rdc
    data: {}
  mode: single
  icon: mdi:shower
aspi_pause:
  alias: mets l'aspirateur en pause
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: vacuum.wall_e
        state: cleaning
      sequence:
      - service: vacuum.pause
        target:
          entity_id: vacuum.wall_e
    - conditions:
      - condition: state
        entity_id: vacuum.r2d2
        state: cleaning
      sequence:
      - service: vacuum.pause
        target:
          entity_id: vacuum.r2d2
    default: []
  mode: single
  icon: mdi:pause
aspi_retour_base:
  alias: range l'aspirateur
  sequence:
  - choose:
    - conditions:
      - condition: not
        conditions:
        - condition: state
          entity_id: vacuum.wall_e
          state: docked
      sequence:
      - service: vacuum.return_to_base
        data: {}
        entity_id: vacuum.wall_e
    - conditions:
      - condition: not
        conditions:
        - condition: state
          entity_id: vacuum.r2d2
          state: docked
      sequence:
      - service: vacuum.return_to_base
        data: {}
        entity_id: vacuum.r2d2
    default: []
  mode: single
  icon: mdi:power-plug
bon_soiree_message_tv:
  alias: 'Bon soirée (message tv) '
  sequence:
  - data:
      message: Bonne soirée !
    service: notify.tv_salon
  mode: single
vive_la_france:
  alias: Vive la France
  sequence:
  - service: script.vol_5_partout
    data: {}
  - service: media_player.play_media
    data:
      entity_id: media_player.le_bureau
      media_content_type: AMAZON_MUSIC
      media_content_id: la marseillaise
    entity_id: media_player.le_bureau
  - wait_for_trigger:
    - platform: state
      entity_id: media_player.sejour
      from: playing
    timeout: 00:00:10
    continue_on_timeout: true
  - service: light.turn_on
    data:
      effect: France
    target:
      entity_id: light.bandeau_led,light.trilampe_centre,light.lampadaire
  - service: light.turn_on
    data:
      color_name: blue
      brightness_pct: 100
    target:
      entity_id: light.trilampe_gauche
  - service: light.turn_on
    data:
      color_name: white
      brightness_pct: 100
    target:
      entity_id: light.trilampe_centre
  - service: light.turn_on
    data:
      color_name: red
      brightness_pct: 100
    target:
      entity_id: light.trilampe_droite
  - wait_for_trigger:
    - platform: state
      entity_id: media_player.sejour
      to: paused
    timeout: 00:02:00
    continue_on_timeout: true
  - service: light.turn_off
    data: {}
    entity_id: light.bandeau_led
  - service: light.turn_off
    data: {}
    target:
      entity_id:
      - light.trilampe_centre
      - light.trilampe_droite
      - light.trilampe_gauche
  - service: light.turn_off
    data: {}
    entity_id: light.lampadaire
  mode: single
trilampe_noel:
  alias: Trilampe effet Noel
  sequence:
  - service: light.turn_on
    data:
      transition: 10
      color_name: red
      brightness_pct: 100
    entity_id: light.trilampe_centre
  - service: light.turn_on
    data:
      transition: 15
      color_name: green
      brightness_pct: 20
    entity_id: light.trilampe_droite
  - service: light.turn_on
    data:
      transition: 5
      color_name: green
      brightness_pct: 20
    entity_id: light.trilampe_gauche
  mode: single
  icon: mdi:lamp
va_prendre_sa_douche:
  alias: Va prendre sa douche
  sequence:
  - data:
      volume_level: 0.5
    service: media_player.volume_set
    target:
      entity_id: media_player.la_salle_de_bain
  - choose:
    - conditions:
      - condition: numeric_state
        entity_id: sensor.temp_salle_de_bain
        below: 20
      sequence:
      - service: switch.turn_on
        target:
          entity_id: switch.radiateur
        data: {}
    default: []
  mode: single
manon_est_rentree:
  alias: Manon est rentrée
  sequence:
  - service: notify.mobile_app_iphone_aurel
    data:
      title: "Manon est rentrée \U0001F3E0"
      message: 'Coucou Aurel, je suis rentrée à la maison. Manon '
  - service: notify.mobile_app_iphone_alex
    data:
      title: "Manon est rentrée \U0001F3E0"
      message: 'Coucou maman, je suis rentrée à la maison. Manon '
  mode: single
aspi_walle_demarrage:
  alias: Aspi walle démarrage
  sequence:
  - service: vacuum.start
    target:
      entity_id: vacuum.wall_e
  mode: single
  icon: mdi:play
rechargement_integration_ble_monitor:
  alias: Rechargement intégration ble monitor
  sequence:
  - service: homeassistant.reload_config_entry
    data: {}
    target:
      entity_id: sensor.temp_couloir_rdc
  - wait_template: ''
    continue_on_timeout: true
    timeout: 00:02:00
  - choose:
    - conditions:
      - condition: state
        entity_id: sensor.temp_sejour
        state: unavailable
      sequence:
      - service: homeassistant.reload_config_entry
        target:
          device_id: 18499116b1eed241fd2da0674c936a15
        data: {}
    default: []
  mode: single
aspi_r2d2_demarrage:
  alias: 'Aspi r2d2 démarrage '
  sequence:
  - service: vacuum.start
    target:
      entity_id: vacuum.r2d2
  mode: single
  icon: mdi:play
rechargement_integration_myenedis:
  alias: Rechargement MyEnedis
  sequence:
  - service: homeassistant.reload_config_entry
    data: {}
    target:
      entity_id: sensor.myenedis_09397539765420
  mode: single
ambiance_repas_invites:
  alias: Ambiance Repas invités
  sequence:
  - service: light.turn_on
    data:
      color_temp: 330
      brightness_pct: 40
    target:
      entity_id:
      - light.bandeau_led
      - light.buffet
      - light.trilampe_droite
      - light.trilampe_gauche
      - light.trilampe_centre
  - service: light.turn_on
    target:
      entity_id:
      - light.lampadaire
      - light.lustre_salle_a_manger
    data:
      transition: 5
      brightness_pct: 100
      color_temp: 310
  - service: homeassistant.turn_off
    target:
      entity_id:
      - light.lustre_salon
  - service: switch.turn_on
    target:
      entity_id: switch.lampe_tv_salon
  - service: light.turn_off
    target:
      entity_id: light.lampe_de_bureau
  mode: single
  icon: phu:rooms-dining
tv_salon_on_off:
  alias: TV salon on/off
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: media_player.tv_salon
        state: 'off'
      sequence:
      - service: wake_on_lan.send_magic_packet
        data:
          broadcast_address: 192.168.1.255
          mac: 64:cb:e9:7d:fe:64
    - conditions:
      - condition: state
        entity_id: media_player.tv_salon
        state: 'on'
      sequence:
      - service: media_player.turn_off
        data: {}
        target:
          entity_id: media_player.tv_salon
    default: []
  - service: wake_on_lan.send_magic_packet
    data:
      broadcast_address: 192.168.1.255
      mac: 64:cb:e9:7d:fe:64
  mode: single
reveille_tom_annonce_alexa:
  alias: Réveille Tom annonce Alexa
  sequence:
  - service: media_player.play_media
    data:
      media_content_id: les hits du moment
      media_content_type: AMAZON_MUSIC
    target:
      entity_id: media_player.tom
  - wait_for_trigger:
    - platform: state
      entity_id: media_player.tom
      to: playing
    continue_on_timeout: true
    timeout: 00:00:30
  - delay:
      hours: 0
      minutes: 0
      seconds: 20
      milliseconds: 0
  - condition: state
    entity_id: light.chevet_tom
    state: 'off'
  - service: light.turn_on
    data:
      effect: Sunrise
    target:
      entity_id: light.chevet_tom
  mode: single
  icon: mdi:alarm-snooze
theme_jour:
  alias: Thème jour
  sequence:
  - service: frontend.set_theme
    data:
      name: mad_geek
      mode: dark
  mode: single
  icon: mdi:weather-sunny
theme_nuit:
  alias: Thème nuit
  sequence:
  - service: frontend.set_theme
    data:
      name: mad_night
      mode: dark
  mode: single
  icon: mdi:weather-night
theme_reload:
  alias: Thème reload
  sequence:
  - service: frontend.reload_themes
    data: {}
  mode: single
  icon: mdi:refresh-auto
tv_salon_chaine_bas:
  alias: Tv salon chaine bas
  sequence:
  - service: webostv.button
    data:
      entity_id: media_player.tv_salon
      button: CHANNELDOWN
  mode: single
  icon: mdi:skip-previous
tv_salon_chaine_haut:
  alias: Tv salon chaine haut
  sequence:
  - service: webostv.button
    data:
      entity_id: media_player.tv_salon
      button: CHANNELUP
  mode: single
  icon: mdi:skip-next
tv_salon_volume_bas:
  alias: 'Tv salon volume bas '
  sequence:
  - service: webostv.button
    data:
      entity_id: media_player.tv_salon
      button: VOLUMEDOWN
  mode: single
  icon: mdi:volume-minus
tv_salon_volume_haut:
  alias: Tv salon volume haut
  sequence:
  - service: webostv.button
    data:
      entity_id: media_player.tv_salon
      button: VOLUMEUP
  mode: single
  icon: mdi:volume-plus
tv_salon_volume_mute:
  alias: Tv salon volume mute
  sequence:
  - service: webostv.button
    data:
      entity_id: media_player.tv_salon
      button: MUTE
  mode: single
  icon: mdi:volume-variant-off
alarme_sonnette_armee:
  alias: Alarme sonnette armée
  sequence:
  - service: alarm_control_panel.alarm_arm_away
    data: {}
    target:
      entity_id: alarm_control_panel.aarlo_sonnette
  mode: single
  icon: mdi:shield-lock
rechargement_hacs:
  alias: Rechargement hacs
  sequence:
  - service: homeassistant.reload_config_entry
    data: {}
    target:
      entity_id: sensor.hacs
  mode: single
alarme_on_off:
  alias: Alarme on/off
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: alarm_control_panel.alarme
        state: disarmed
      sequence:
      - service: alarm_control_panel.alarm_arm_away
        data: {}
        target:
          entity_id: alarm_control_panel.alarme
    - conditions:
      - condition: not
        conditions:
        - condition: state
          entity_id: alarm_control_panel.alarme
          state: disarmed
      sequence:
      - service: alarm_control_panel.alarm_disarm
        data:
          code: '4321'
        target:
          entity_id: alarm_control_panel.alarme
    default: []
  mode: single
  icon: mdi:shield-lock-outline
alarme_sonnette_on_off:
  alias: 'Alarme sonnette on/off '
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: alarm_control_panel.aarlo_sonnette
        state: disarmed
      sequence:
      - service: alarm_control_panel.alarm_arm_away
        data: {}
        target:
          entity_id: alarm_control_panel.aarlo_sonnette
    - conditions:
      - condition: not
        conditions:
        - condition: state
          entity_id: alarm_control_panel.aarlo_sonnette
          state: disarmed
      sequence:
      - service: alarm_control_panel.alarm_disarm
        data: {}
        target:
          entity_id: alarm_control_panel.aarlo_sonnette
    default: []
  mode: single
  icon: mdi:shield-lock-outline
nina_couche:
  alias: 'Nina couché '
  sequence:
  - service: script.vol_5_partout
    data: {}
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - data:
      data:
        type: announce
      message: Nina, C'est l'heure d'aller aul it... {{ states.sensor.filles_reveil_annonce.state
        }}. Bisous, et Bonne nuit.
      target:
      - group.echos
    service: notify.alexa_media
  - delay:
      hours: 0
      minutes: 0
      seconds: 25
      milliseconds: 0
  - service: scene.turn_on
    target:
      entity_id: scene.nina_ambiance_nuit
    metadata: {}
  - service: script.vol_1_chambre_enfants
    data: {}
  - service: script.vol_2_rdc
    data: {}
  - wait_template: ''
    timeout: 00:02:00
    continue_on_timeout: true
  - service: switch.turn_off
    target:
      entity_id:
      - switch.moustique_nina
    data: {}
  - type: turn_on
    device_id: cb4921c1744240b7a12ec54a13ad35f6
    entity_id: switch.manon_do_not_disturb_switch
    domain: switch
  - type: turn_on
    device_id: c6f009055e09423a80b498878a043f25
    entity_id: switch.leane_do_not_disturb_switch
    domain: switch
  - type: turn_on
    device_id: 021f28bbf0ca4bf88cd9a927413278fa
    entity_id: switch.nina_do_not_disturb_switch
    domain: switch
  mode: single
  icon: mdi:sleep
alarme_disarmed:
  alias: Alarme disarmed
  sequence:
  - service: alarm_control_panel.alarm_disarm
    data:
      code: '4321'
    target:
      entity_id: alarm_control_panel.alarme
  mode: single
  icon: mdi:shield-off
alarme_armed_away:
  alias: Alarme armed_away
  sequence:
  - service: alarm_control_panel.alarm_arm_away
    data: {}
    target:
      entity_id: alarm_control_panel.alarme
  mode: single
  icon: mdi:shield-lock
alarme_armed_home:
  alias: Alarme armed_home
  sequence:
  - service: alarm_control_panel.alarm_arm_home
    data: {}
    target:
      entity_id: alarm_control_panel.alarme
  mode: single
  icon: mdi:shield-home
alarme_armed_night:
  alias: Alarme armed_night
  sequence:
  - service: alarm_control_panel.alarm_arm_night
    data: {}
    target:
      entity_id: alarm_control_panel.alarme
  mode: single
  icon: mdi:shield-moon
alarme_sonnette_disarmed:
  alias: Alarme sonnette disarmed
  sequence:
  - service: alarm_control_panel.alarm_disarm
    data: {}
    target:
      entity_id: alarm_control_panel.aarlo_sonnette
  mode: single
  icon: mdi:shield-off
tv_parents_bas:
  alias: 'Tv parents bas '
  sequence:
  - service: androidtv.adb_command
    data:
      command: DOWN
    target:
      entity_id: media_player.cube_tv
  mode: single
  icon: mdi:chevron-down
tv_parents_haut:
  alias: Tv parents haut
  sequence:
  - service: androidtv.adb_command
    data:
      command: UP
    target:
      entity_id: media_player.cube_tv
  mode: single
  icon: mdi:chevron-up
tv_parents_gauche:
  alias: Tv parents gauche
  sequence:
  - service: androidtv.adb_command
    data:
      command: LEFT
    target:
      entity_id: media_player.cube_tv
  mode: single
  icon: mdi:chevron-left
tv_parents_droite:
  alias: Tv parents droite
  sequence:
  - service: androidtv.adb_command
    data:
      command: RIGHT
    target:
      entity_id: media_player.cube_tv
  mode: single
  icon: mdi:chevron-right
tv_parents_menu:
  alias: Tv parents menu
  sequence:
  - service: androidtv.adb_command
    data:
      command: HOME
    target:
      entity_id: media_player.cube_tv
  mode: single
  icon: mdi:menu
test:
  alias: Alerte intrusion école (jeu enfants)
  sequence:
  - service: script.vol_5_partout
    data: {}
  - delay:
      hours: 0
      minutes: 0
      seconds: 2
      milliseconds: 0
  - service: media_player.play_media
    data:
      media_content_type: sound
      media_content_id: amzn_sfx_scifi_alarm_01
    entity_id: media_player.tom,media_player.nina,media_player.leane,media_player.manon
  - data:
      data:
        type: tts
      message: Ceci est un exercice. Alerte intrusion. Veuillez rejoindre le point
        de sécurité de l'école, situé au rez-de-chaussée , dans le réfectoire..
      target:
      - media_player.tom,media_player.nina,media_player.leane,media_player.manon
    service: notify.alexa_media
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: media_player.play_media
    data:
      media_content_type: sound
      media_content_id: amzn_sfx_scifi_alarm_01
    entity_id: media_player.tom,media_player.nina,media_player.leane,media_player.manon
  mode: single
ambiance_cine:
  alias: Ambiance ciné
  sequence:
  - parallel:
    - service: script.ambiance_cine_chevet_parents
      data: {}
    - service: switch.turn_on
      data: {}
      target:
        entity_id: switch.tele_des_parents
  mode: single
  icon: mdi:theater
eteins_la_chambre_des_parents:
  alias: Éteins la chambre des parents
  sequence:
  - if:
    - condition: state
      entity_id: switch.tele_des_parents
      state: 'on'
    then:
    - service: scene.turn_on
      target:
        entity_id: scene.chambre_parents_ambiance_normale
      metadata: {}
    - delay:
        hours: 0
        minutes: 0
        seconds: 5
        milliseconds: 0
    - service: switch.turn_off
      data: {}
      target:
        entity_id: switch.tele_des_parents
    - service: light.turn_off
      data: {}
      target:
        entity_id: light.parents
    else:
    - service: light.turn_off
      data:
        transition: 10
      target:
        entity_id: light.parents
  mode: single
  icon: mdi:lightbulb-group-off
je_ne_travaille_plus:
  alias: Je ne travaille plus
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: light.bandeau_led
        state: 'on'
      - condition: state
        entity_id: light.lampe_canape
        state: 'on'
      - condition: state
        entity_id: light.lampe_tv_salon
        state: 'on'
      sequence:
      - service: scene.turn_on
        target:
          entity_id: scene.ambiance_normale
        metadata: {}
    - conditions:
      - condition: state
        entity_id: light.bandeau_led
        state: 'off'
      - condition: state
        entity_id: light.lampe_canape
        state: 'off'
      - condition: state
        entity_id: light.lampe_tv_salon
        state: 'on'
      sequence:
      - service: scene.turn_on
        target:
          entity_id: scene.tv
        metadata: {}
    default:
    - service: light.turn_off
      data: {}
      target:
        entity_id: light.sam
  mode: single
ouvre_le_garage:
  alias: Ouvre le garage
  mode: restart
  sequence:
  - condition: or
    conditions:
    - condition: state
      entity_id: lock.garage
      state: locked
    - condition: state
      entity_id: lock.garage
      state: unavailable
  - service: lock.unlock
    data: {}
    target:
      entity_id: lock.garage
  - wait_for_trigger:
    - platform: state
      entity_id:
      - lock.garage
      to: unlocked
    continue_on_timeout: true
    timeout:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - condition: not
    conditions:
    - condition: state
      entity_id: lock.garage
      state: unlocked
  - service: homeassistant.reload_config_entry
    data: {}
    target:
      entity_id: lock.garage
  - repeat:
      until:
      - condition: state
        entity_id: lock.garage
        state: unlocked
      sequence:
      - service: lock.unlock
        data: {}
        target:
          entity_id: lock.garage
      - delay:
          hours: 0
          minutes: 1
          seconds: 0
          milliseconds: 0
  icon: mdi:lock-open
ferme_le_garage:
  alias: Ferme le garage
  mode: restart
  sequence:
  - if:
    - condition: state
      entity_id: binary_sensor.porte_garage
      state: 'off'
    - condition: state
      entity_id: lock.garage
      state: unlocked
    then:
    - service: lock.lock
      data: {}
      target:
        entity_id: lock.garage
    - wait_for_trigger:
      - platform: state
        entity_id:
        - lock.garage
        to: locked
      continue_on_timeout: true
      timeout:
        hours: 0
        minutes: 0
        seconds: 10
        milliseconds: 0
    - condition: not
      conditions:
      - condition: state
        entity_id: lock.garage
        state: locked
    - service: homeassistant.reload_config_entry
      data: {}
      target:
        entity_id: lock.garage
    - repeat:
        until:
        - condition: state
          entity_id: lock.garage
          state: locked
        sequence:
        - service: lock.lock
          data: {}
          target:
            entity_id: lock.garage
        - delay:
            hours: 0
            minutes: 1
            seconds: 0
            milliseconds: 0
    else:
    - if:
      - condition: state
        entity_id: lock.garage
        state: locked
      then:
      - stop: Serrure déjà fermée
      else:
      - if:
        - condition: state
          entity_id: binary_sensor.porte_garage
          state: 'on'
        then:
        - service: notify.notify
          data:
            title: ⚠️ Serrure garage
            message: 'Verrouillage du garage impossible, la porte est ouverte. '
            data:
              actions:
              - action: FERMER_GARAGE
                title: Essayer de vérrouiller le garage à nouveau
                destructive: true
              - action: rien
                title: Non
        else:
        - service: notify.notify
          data:
            title: ⚠️ Serrure garage
            message: 'Verrouillage du garage impossible, la serrure est coincée. '
            data:
              actions:
              - action: FERMER_GARAGE
                title: Essayer de vérrouiller le garage à nouveau
                destructive: true
              - action: OUVRIR_GARAGE
                title: Essayer de dévérrouiller le garage à nouveau
                destructive: true
              - action: rien
                title: Non
  icon: mdi:lock
garage_serrure_toggle:
  alias: garage serrure toggle
  sequence:
  - if:
    - condition: state
      entity_id: lock.garage
      state: locked
    then:
    - service: script.ouvre_le_garage
      data: {}
    else:
    - service: script.ferme_le_garage
      data: {}
  mode: single
  icon: mdi:lock
redemarrer_le_pont_tenda_nova:
  alias: Redémarrer le pont Tenda Nova
  sequence:
  - service: switch.turn_off
    data: {}
    target:
      entity_id: switch.tenda_naova
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - service: switch.turn_on
    data: {}
    target:
      entity_id: switch.tenda_naova
  mode: single
  icon: mdi:reload-alert
ouvre_lentree:
  alias: Ouvre l'entrée
  mode: restart
  sequence:
  - condition: or
    conditions:
    - condition: state
      entity_id: lock.serrure_entree
      state: locked
    - condition: state
      entity_id: lock.serrure_entree
      state: unavailable
  - service: lock.unlock
    data: {}
    target:
      entity_id: lock.serrure_entree
  - wait_for_trigger:
    - platform: state
      entity_id:
      - lock.serrure_entree
      to: unlocked
    continue_on_timeout: true
    timeout:
      hours: 0
      minutes: 0
      seconds: 10
      milliseconds: 0
  - condition: not
    conditions:
    - condition: state
      entity_id: lock.serrure_entree
      state: unlocked
  - service: homeassistant.reload_config_entry
    data: {}
    target:
      entity_id: lock.serrure_entree
  - repeat:
      until:
      - condition: state
        entity_id: lock.serrure_entree
        state: unlocked
      sequence:
      - service: lock.unlock
        data: {}
        target:
          entity_id: lock.serrure_entree
      - delay:
          hours: 0
          minutes: 0
          seconds: 30
          milliseconds: 0
ferme_lentree:
  alias: Ferme l'entrée
  mode: restart
  sequence:
  - if:
    - condition: state
      entity_id: binary_sensor.porte_entree
      state: 'off'
    - condition: state
      entity_id: lock.serrure_entree
      state: unlocked
    then:
    - service: lock.lock
      data: {}
      target:
        entity_id: lock.serrure_entree
    - wait_for_trigger:
      - platform: state
        entity_id:
        - lock.serrure_entree
        to: locked
      continue_on_timeout: true
      timeout:
        hours: 0
        minutes: 0
        seconds: 10
        milliseconds: 0
    - condition: not
      conditions:
      - condition: state
        entity_id: lock.serrure_entree
        state: locked
    - service: homeassistant.reload_config_entry
      data: {}
      target:
        entity_id: lock.serrure_entree
    - repeat:
        until:
        - condition: state
          entity_id: lock.serrure_entree
          state: locked
        sequence:
        - service: lock.lock
          data: {}
          target:
            entity_id: lock.serrure_entree
        - delay:
            hours: 0
            minutes: 0
            seconds: 30
            milliseconds: 0
    else:
    - if:
      - condition: state
        entity_id: lock.serrure_entree
        state: locked
      then:
      - stop: Serrure déjà fermée
      else:
      - if:
        - condition: state
          entity_id: binary_sensor.porte_entree
          state: 'on'
        then:
        - service: notify.notify
          data:
            title: ⚠️ Serrure entrée
            message: 'Verrouillage de l''entrée impossible, la porte est ouverte. '
            data:
              actions:
              - action: FERMER_ENTREE
                title: Essayer de vérrouiller l'entrée à nouveau
                destructive: true
              - action: rien
                title: Non
        else:
        - service: notify.notify
          data:
            title: ⚠️ Serrure entrée
            message: 'Verrouillage de l''entrée impossible, la serrure est coincée. '
            data:
              actions:
              - action: FERMER_ENTREE
                title: Essayer de vérrouiller l'entrée à nouveau
                destructive: true
              - action: OUVRIR_ENTREE
                title: Essayer de dévérrouiller l'entrée à nouveau
                destructive: true
              - action: rien
                title: Non
  icon: mdi:lock
entree_serrure_toggle:
  alias: 'entrée serrure toggle '
  sequence:
  - if:
    - condition: state
      entity_id: lock.serrure_entree
      state: locked
    then:
    - service: script.ouvre_lentree
      data: {}
    else:
    - service: script.ferme_lentree
      data: {}
  mode: parallel
  icon: mdi:lock
annonce_dans_sejour:
  alias: Annonce dans séjour
  sequence:
  - data:
      data:
        type: announce
      message: '{{ states.input_text.annonce_dans_sejour.state}}'
      target:
      - media_player.le_bureau
      - media_player.le_salon
    service: notify.alexa_media
  mode: single
  icon: mdi:speaker-message
annonce_dans_chambre_de_tom:
  alias: Annonce dans la chambre de Tom
  sequence:
  - data:
      data:
        type: announce
      message: '{{ states.input_text.annonce_dans_chambre_de_tom.state}}'
      target:
      - media_player.tom
    service: notify.alexa_media
  mode: single
  icon: mdi:speaker-message
annonce_dans_salle_de_bain:
  alias: Annonce dans salle de bain
  sequence:
  - data:
      data:
        type: announce
      message: '{{ states.input_text.annonce_dans_salle_de_bain.state}}'
      target:
      - media_player.la_salle_de_bain
    service: notify.alexa_media
  mode: single
  icon: mdi:speaker-message
annonce_dans_chambre_de_manon:
  alias: Annonce dans la chambre de Manon et Léane
  sequence:
  - data:
      data:
        type: announce
      message: '{{ states.input_text.annonce_dans_chambre_de_manon.state}}'
      target:
      - media_player.manon
      - media_player.leane
    service: notify.alexa_media
  mode: single
  icon: mdi:speaker-message
annonce_dans_chambre_de_nina:
  alias: Annonce dans la chambre de Nina
  sequence:
  - data:
      data:
        type: announce
      message: '{{ states.input_text.annonce_dans_chambre_de_nina.state}}'
      target:
      - media_player.nina
    service: notify.alexa_media
  mode: single
  icon: mdi:speaker-message
neolink_stop:
  alias: Neolink stop
  sequence:
  - service: hassio.addon_stop
    data:
      addon: a14d3924_neolink
  mode: single
  icon: mdi:stop
neolink_start:
  alias: Neolink start
  sequence:
  - service: hassio.addon_start
    data:
      addon: a14d3924_neolink
  mode: single
  icon: mdi:play
motioneye_start:
  alias: Motioneye start
  sequence:
  - service: hassio.addon_start
    data:
      addon: a0d7b954_motioneye
  mode: single
  icon: mdi:play
motioneye_stop:
  alias: Motioneye stop
  sequence:
  - service: hassio.addon_stop
    data:
      addon: a0d7b954_motioneye
  mode: single
  icon: mdi:stop
backup_full_ha:
  alias: Backup full HA
  sequence:
  - service: hassio.backup_full
    data:
      compressed: true
  mode: single
  icon: mdi:cloud-upload
